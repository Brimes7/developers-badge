import { runCoors } from "../../utils/cors";

async function handler( req, res ){
  const { name } = req.query;
  // Run the middleware
  runCoors( req, res )
    .then( result => {
      debugger;
      const svg = getDevTo( name );
      res.setHeader( "content-type", "image/svg+xml" );
      res.send( svg );
    } ).catch( err => {
    
    // Rest of the API logic
    res.status( 400 ).json( { message: err.message } );
  } );
  
}

const getDevTo = ( name, height = 30 ) => {
  return `
<svg width="118" height="${ height }" viewBox="0 0 118 15" fill="none"
     xmlns="http://www.w3.org/2000/svg">
    <g id="devTo">
        <g id="Group">
            <path id="Vector"
                  d="M116 0H2C0.89543 0 0 0.89543 0 2V13C0 14.1046 0.89543 15 2 15H116C117.105 15 118 14.1046 118 13V2C118 0.89543 117.105 0 116 0Z"
                  fill="black"/>
            <g id="DevTo 1">
                <path id="Vector_2"
                      d="M23.7154 0.829834H1.99976C1.44747 0.829834 0.999756 1.27755 0.999756 1.82983V13.1698C0.999756 13.7221 1.44747 14.1698 1.99976 14.1698H23.7154C24.2676 14.1698 24.7154 13.7221 24.7154 13.1698V1.82983C24.7154 1.27755 24.2676 0.829834 23.7154 0.829834Z"
                      fill="white"/>
                <path id="Vector_3"
                      d="M2.2702 7.47136V12.6046H4.08288C6.08805 12.6046 6.9222 12.348 7.53177 11.5619C8.14134 10.792 8.23759 10.1182 8.17342 7.07033C8.1253 4.37538 8.09322 4.1508 7.74031 3.57331C7.13074 2.57875 6.457 2.33813 4.19517 2.33813H2.2702V7.47136ZM5.97576 4.40746C6.34471 4.71225 6.36075 4.77641 6.36075 7.37511C6.36075 9.89361 6.34471 10.0541 6.00784 10.3909C5.73514 10.6476 5.44639 10.7438 4.88495 10.7438L4.11496 10.7599L4.06684 7.42324L4.03475 4.10268H4.82078C5.35014 4.10268 5.7191 4.19892 5.97576 4.40746ZM9.66527 2.7552C9.34444 3.17228 9.3284 3.38083 9.3284 7.50346V11.8186L9.72944 12.2036C10.0984 12.5886 10.1946 12.6046 12.2961 12.6046H14.4616V10.8561L12.8254 10.808L11.1732 10.7599V8.35365L12.1838 8.30552L13.1783 8.25739V6.50888H11.093V4.10268H14.4616V2.33813H12.2319C10.0021 2.33813 9.9861 2.33813 9.66527 2.7552ZM16.2262 4.616C16.5631 5.88327 17.1085 7.95261 17.4453 9.23592C17.9587 11.209 18.1351 11.6421 18.5682 12.0753C18.873 12.3961 19.242 12.6046 19.4826 12.6046C19.9799 12.6046 20.6215 12.1073 20.8461 11.5299C21.0065 11.1128 23.2844 2.61083 23.2844 2.41833C23.2844 2.37021 22.8352 2.33813 22.2898 2.37021L21.2792 2.41833L20.3809 5.86723C19.8195 8.04885 19.4505 9.20384 19.3863 8.9953C19.258 8.59427 17.6699 2.4825 17.6699 2.40229C17.6699 2.37021 17.2047 2.33813 16.6433 2.33813H15.6166L16.2262 4.616Z"
                      fill="black"/>
            </g>
            <text id="name" fill="white" xml:space="preserve"
                  style="white-space: pre" font-family="Roboto" font-size="9"
                  letter-spacing="0em"><tspan x="33.7589" y="10.4967">${ name }</tspan></text>
        </g>
    </g>
</svg>
`;
};

export default handler;
